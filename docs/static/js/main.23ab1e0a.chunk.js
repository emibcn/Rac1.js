(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){"use strict";(function(e){var a=n(9),i=n(7),r=n(14),o=n(12),c=n(13),s=n(1),l=n.n(s),u=n(0),d=n(61),h=function(t){function n(){var e;Object(a.a)(this,n);return(e=Object(r.a)(this,Object(o.a)(n).call(this))).loadGoogleTag("UA-129704402-1"),d.a.initialize("UA-129704402-1"),e}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.sendPageView(this.context.router.history.location),this.context.router.history.listen(this.sendPageView)}},{key:"sendPageView",value:function(e){d.a.set({page:e.pathname}),d.a.pageview(e.pathname)}},{key:"loadGoogleTag",value:function(t){e.dataLayer=e.dataLayer||[],e.gtag=function(){e.dataLayer.push(arguments)},e.gtag("js",new Date),e.gtag("config",t),setTimeout(function(){var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id=".concat(t),document.body.appendChild(e)},1)}},{key:"render",value:function(){return this.props.children}}]),n}(l.a.Component);h.contextTypes={router:u.PropTypes.object};var p=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;return"1"===e||"yes"===e?this.props.children:l.a.createElement(h,null,this.props.children)}}]),t}(l.a.Component);t.a=p}).call(this,n(83))},111:function(e,t,n){e.exports=n(224)},116:function(e,t,n){},135:function(e,t,n){},221:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(10),o=n.n(r),c=(n(116),n(15)),s=n(9),l=n(7),u=n(14),d=n(12),h=n(13),p=n(226),m=n(229),f=n(228),y=n(227),g=n(225),v=n(8),k=n(6),b=n(39),w=n.n(b),E=n(82),j=(n(135),function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(d.a)(t).call(this))).state={isOpen:!1},e}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderLinks",value:function(){var e=this.props,t=e.newServiceWorkerDetected,n=e.children;return i.a.createElement("div",{style:{padding:"3em 1em 1em",background:"url(logo-rac1.png)",backgroundSize:50,backgroundRepeat:"no-repeat",backgroundPosition:"center .5em"}},i.a.createElement(g.a,{className:"bm-item",onClick:this.handleClick.bind(this),to:"/"},i.a.createElement(v.a,{icon:k.c,style:{marginRight:".5em"}}),i.a.createElement("span",null,"By date")),i.a.createElement(g.a,{className:"bm-item",onClick:this.handleClick.bind(this),to:"/directe"},i.a.createElement(v.a,{icon:k.b,style:{marginRight:".5em"}}),i.a.createElement("span",null,"En directe")),t?i.a.createElement("a",{href:"/",className:"bm-item",style:{color:"green"},title:"New version available!",onClick:this.handleClickUpdate.bind(this)},i.a.createElement(v.a,{icon:k.a,style:{marginRight:".5em"}}),i.a.createElement("span",null,"Update!")):null,n)}},{key:"render",value:function(){var e=this,t=this.props.newServiceWorkerDetected,n=this.state.isOpen,a=t?" news":"";return i.a.createElement(w.a,{minWidth:700},function(t){return t?i.a.createElement("div",{className:"menu-big"+a},i.a.createElement(E.scaleRotate,{pageWrapId:"page-wrap",outerContainerId:"outer-container",isOpen:n,onStateChange:function(t){return e.handleMenuStateChange(t.isOpen)},disableCloseOnEsc:!0},e.renderLinks())):i.a.createElement("div",{className:"menu-small"+a},i.a.createElement(E.slide,{pageWrapId:"page-wrap",outerContainerId:"outer-container",isOpen:n,onStateChange:function(t){return e.handleMenuStateChange(t.isOpen)},disableCloseOnEsc:!0},e.renderLinks()))})}},{key:"handleMenuStateChange",value:function(e){this.setState({isOpen:e})}},{key:"handleClick",value:function(e){this.handleMenuStateChange(!1)}},{key:"handleClickUpdate",value:function(e){e.preventDefault(),this.handleMenuStateChange(!1),this.props.onLoadNewServiceWorkerAccept()}}]),t}(i.a.Component));j.defaultProps={onLoadNewServiceWorkerAccept:function(){},newServiceWorkerDetected:!1};var P=j,O=n(103),C=n(56),D=n.n(C),S=n(59),x=n(40),U=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"keysString",value:function(){if(0===this.props.keys.length)return"";var e=Object(x.a)(new Set(this.props.keys.map(function(e){return" "===e?"Space":e}).map(function(e){return 1===e.length?e.toUpperCase():e})));return" | Key".concat(e.length>1?"s":"",": ").concat(e.join(", "))}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.help,a=e.icon,r=e.action,o=(e.keys,e.style),s=e.className,l=Object(S.a)(e,["text","help","icon","action","keys","style","className"]),u=Object(c.a)({borderRadius:"1em",padding:".7em",margin:"1em"},o),d=n+this.keysString();return i.a.createElement("button",Object.assign({onClick:r,"aria-label":d,title:d,className:"rac1-controls-button"+(s?" ".concat(s):""),style:u},l),i.a.createElement("div",{style:{fontSize:"calc(1em + 2.5vmin)",fontWeight:"bold",minWidth:"1.5em"}},a instanceof Function?a():a),i.a.createElement("span",{style:{fontSize:"calc(8px + 1vmin)",color:"#333"}},t instanceof Function?t():t))}}]),t}(i.a.PureComponent);U.defaultProps={action:function(){},keys:[]};var F=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.buttons,a=t.keyHandlerFocus,r=t.children;return i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},n.map(function(t,n){return i.a.createElement(U,{key:n,onMouseUp:function(e){return a(e,!0)},action:t.action.bind(e),help:t.help,text:t.text,icon:t.icon,keys:t.keys})}),r)}}]),t}(i.a.PureComponent);F.defaultProps={keyHandlerFocus:function(e,t){}};var A=n(109),M=(n(190),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.volume,a=t.muted,r="Volume handler | Keys: Shift + Arrow Up, Shift + Arrow Down",o=a?k.l:0===n?k.m:n<.5?k.k:k.n;return i.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end"}},i.a.createElement("div",{style:{width:"100%",minWidth:40,height:100,display:"flex",alignItems:"center",flexDirection:"column",paddingTop:".3em"}},i.a.createElement(A.a,{onAfterChange:function(){return e.props.keyHandlerFocus()},onChange:function(t){return e.props.onSetVolume(t/100)},value:100*n,vertical:!0,"aria-label":r,title:r})),i.a.createElement("div",null,i.a.createElement(U,{onMouseUp:function(t){return e.props.keyHandlerFocus(t,!0)},action:function(){return e.props.onSetMuted(!a)},help:"Toggle mute status",text:a?"Unmute":"Mute",icon:i.a.createElement(v.a,{icon:o}),keys:["M"]})))}}]),t}(i.a.Component));M.defaultProps={keyHandlerFocus:function(){},onSetVolume:function(e){},onSetMuted:function(e){},volume:1,muted:!1};var N=M,T=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this))).controls=[{icon:i.a.createElement(v.a,{icon:k.f,flip:"horizontal"}),text:"Prev",help:"Play previous podcast",action:function(){return n.props.onPlayPrev()},group:"basic"},{icon:i.a.createElement("span",null,i.a.createElement(v.a,{icon:k.g,flip:"horizontal"}),i.a.createElement(v.a,{icon:k.g,flip:"horizontal"})),text:"-10m",help:"Go backwards 10 minutes",action:function(){return n.player().currentTime-=600},keys:["PageUp"],group:"advanced prev"},{icon:i.a.createElement("span",null,i.a.createElement(v.a,{icon:k.g,flip:"horizontal",style:{position:"relative",left:".25em"}}),i.a.createElement(v.a,{icon:k.g,flip:"horizontal",style:{position:"relative",left:"-.25em"}})),text:"-60s",help:"Go backwards 1 minute",action:function(){return n.player().currentTime-=60},keys:["ArrowUp"],group:"advanced prev"},{icon:i.a.createElement(v.a,{icon:k.g,flip:"horizontal"}),text:"-10s",help:"Go backwards 10 seconds",action:function(){return n.player().currentTime-=10},keys:["ArrowLeft"],group:"advanced prev"},{icon:function(){return n.props.isPlaying?i.a.createElement(v.a,{icon:k.h}):i.a.createElement(v.a,{icon:k.i})},text:function(){return n.props.isPlaying?"Pause":"Play"},help:"Toggle Play/Pause",action:function(){return n.player().paused?n.player().play():n.player().pause()},keys:[" ","p","P"],group:"basic"},{icon:i.a.createElement(v.a,{icon:k.g}),text:"+10s",help:"Go forward 10 seconds",action:function(){return n.player().currentTime+=10},keys:["ArrowRight"],group:"advanced next"},{icon:i.a.createElement("span",null,i.a.createElement(v.a,{icon:k.g,style:{position:"relative",left:".25em"}}),i.a.createElement(v.a,{icon:k.g,style:{position:"relative",left:"-.25em"}})),text:"+60s",help:"Go forward 1 minute",action:function(){return n.player().currentTime+=60},keys:["ArrowDown"],group:"advanced next"},{icon:i.a.createElement("span",null,i.a.createElement(v.a,{icon:k.g}),i.a.createElement(v.a,{icon:k.g})),text:"+10m",help:"Go forward 10 minutes",action:function(){return n.player().currentTime+=600},keys:["PageDown"],group:"advanced next"},{icon:i.a.createElement(v.a,{icon:k.f}),text:"Next",help:"Play next podcast",action:function(){return n.props.onPlayNext()},keys:["Enter"],group:"basic"},{help:"Decrement volume 5%",action:function(){return n.incrementVolume(-.05)},keys:["/",{key:"ArrowDown",shiftKey:!0}]},{help:"Increment volume 5%",action:function(){return n.incrementVolume(.05)},keys:["*",{key:"ArrowUp",shiftKey:!0}]},{help:"Toggle mute status",action:function(){return n.setMuted(!n.player().muted)},keys:["m","M"]}],n.keyHandlerFocus=function(){},n._keyHandlerFocus=function(e,t){var a=!0;e&&e.relatedTarget&&n.props.allowFocus(e.relatedTarget)&&(a=!1),(a||t)&&(n.timer=setTimeout(function(){return n._keyHandler.focus()},100))},n.player=function(){return n.props.getPlayer()},e.extraControls.length&&(n.controls=n.controls.concat(e.extraControls)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.noKeys=!0,/Mobi|Android/i.test(navigator.userAgent)||(this.noKeys=!1,this.keyHandlerFocus=this._keyHandlerFocus,this.keyHandlerFocus())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"filterButtonsGroup",value:function(e,t){var n=this,a=this.props.hideButtons;return e.filter(function(e){return"icon"in e&&"text"in e}).filter(function(e){return!a.includes(e.text)}).filter(function(e){return e.group.split(" ").includes(t)}).map(function(e){if(n.noKeys){var t=e.keys,a=Object(S.a)(e,["keys"]);return console.log({keys:t}),a}return e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.showAdvanced,a=t.volumeAsAdvanced,r=t.volume,o=t.muted,c=["basic","advanced"].reduce(function(t,n){return t[n]=e.filterButtonsGroup(e.controls,n),t},{});return i.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end"}},c.basic.length?i.a.createElement("div",{style:{display:"flex",alignItems:"flex-end"}},i.a.createElement(F,{buttons:c.basic,keyHandlerFocus:this.keyHandlerFocus.bind(this)},c.advanced.length?i.a.createElement(U,{onMouseUp:function(t){return e.keyHandlerFocus(t,!0)},action:this.handleShowAdvancedChange.bind(this,!n),help:"Show ".concat(n?"less":"more"," controls"),text:n?"Less":"More",icon:i.a.createElement(v.a,{icon:n?k.e:k.d})}):null),a?null:i.a.createElement(N,{volume:r,muted:o,onSetVolume:this.setVolume.bind(this),onSetMuted:this.setMuted.bind(this),keyHandlerFocus:this.keyHandlerFocus.bind(this)})):null,i.a.createElement("div",{style:{display:"flex"}},n&&c.advanced.length?i.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},i.a.createElement(F,{buttons:this.filterButtonsGroup(c.advanced,"prev"),keyHandlerFocus:this.keyHandlerFocus.bind(this)}),i.a.createElement(F,{buttons:this.filterButtonsGroup(c.advanced,"next"),keyHandlerFocus:this.keyHandlerFocus.bind(this)})):null,n&&a?i.a.createElement(N,{volume:r,muted:o,onSetVolume:this.setVolume.bind(this),onSetMuted:this.setMuted.bind(this),keyHandlerFocus:this.keyHandlerFocus.bind(this)}):null),i.a.createElement("input",{name:"player-key-handler",style:{width:"1px",height:"1px",border:0,margin:0,padding:0,bottom:0,right:0,position:"fixed",backgroundColor:"transparent",color:"transparent",cursor:"default"},ref:function(t){e._keyHandler=t},onKeyUp:this.handleKey.bind(this),onBlur:this.keyHandlerFocus.bind(this),"aria-label":"Key input handler"}))}},{key:"setMuted",value:function(e){this.player().muted=e,this.props.onSetMuted(e)}},{key:"setVolume",value:function(e){this.player().volume=e,this.props.onSetVolume(e)}},{key:"incrementVolume",value:function(e){var t=this.props.volume,n=t;e>0&&t<1&&(n=t<=1-e?t+e:1),e<0&&t>0&&(n=t>=-e?t+e:0),n!==t&&this.setVolume(n)}},{key:"handleKey",value:function(e){var t=!1;this.controls.forEach(function(n){(n.keys||[]).forEach(function(a){var i="string"===typeof a?{key:a}:a;e.key===i.key&&["shiftKey","altKey","ctrlKey","metaKey"].every(function(t){return!!e[t]===!!i[t]})&&(console.log(n.help),t=!0,n.action())})}),t&&(e.stopPropagation(),e.preventDefault())}},{key:"handleShowAdvancedChange",value:function(e,t){t.preventDefault(),this.props.onShowAdvancedChange(e)}}]),t}(i.a.Component);T.defaultProps={onSetVolume:function(e){},onSetMuted:function(e){},onPlayPrev:function(e){},onPlayNext:function(e){},allowFocus:function(e){},onShowAdvancedChange:function(e){},extraControls:[],hideButtons:[],volume:1,muted:!1,isPlaying:!1,showAdvanced:!1,volumeAsAdvanced:!1};var W=T,L=function(e){function t(e,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this))).state={volume:1},a.history=e.history,a.state={volume:1,muted:!1,isPlaying:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"player",value:function(){return this._player.audioEl}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.initialTitle=document.title,document.title="".concat(this.initialTitle," - Directe")}},{key:"componentWillUnmount",value:function(){document.title=this.initialTitle}},{key:"render",value:function(){var e=this,t=this.state,n=t.volume,a=t.muted,r=t.isPlaying;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",null,"Rac1 en Directe"),i.a.createElement(W,{getPlayer:this.player.bind(this),volume:n,muted:a,allowFocus:function(e){return e.className.match(/rc-slider-handle/)},isPlaying:r,onSetVolume:function(t){return e.setState(Object(c.a)({},e.state,{volume:t}))},onSetMuted:function(t){return e.setState(Object(c.a)({},e.state,{muted:t}))},hideButtons:["Prev","Next","-10m","-60s","-10s","+10m","+60s","+10s"]}),i.a.createElement(D.a,{ref:function(t){e._player=t},style:{width:"100%"},src:"http://rac1.radiocat.net/;*.nsv",autoPlay:!0,title:"Rac1 en Directe",controls:!0,controlsList:"nodownload",preload:"auto",volume:n,muted:a,onPlay:this.handlePlayStatusChange.bind(this,!0),onPause:this.handlePlayStatusChange.bind(this,!1),onVolumeChanged:function(t){return e.setState(Object(c.a)({},e.state,{volume:t.currentTarget.volume,muted:t.currentTarget.muted}))}}))}},{key:"handlePlayStatusChange",value:function(e){this.setState(Object(c.a)({},this.state,{isPlaying:e}))}}]),t}(a.Component),H=n(46),_=n(107),R=n.n(_),I=function(e){return i.a.createElement("button",Object.assign({},e,{"aria-label":"Reload",style:{borderRadius:".5em",padding:".25em",margin:"0 0 0 1em"}}),i.a.createElement("div",{style:{fontSize:"calc(.5em + 2vmin)",fontWeight:"bold",marginBottom:"-.25em"}},i.a.createElement(v.a,{icon:k.j})),i.a.createElement("span",{style:{fontSize:"calc(5px + 1vmin)",color:"#333"}},"Reload"))},B=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.completedDownload,n=e.date,a=e.children,r=e.minDate,o=e.maxDate;return i.a.createElement("div",{style:{color:"#333",backgroundColor:"white",padding:"2em",borderRadius:"1em",margin:"1em",textAlign:"left",position:"relative",fontSize:"large"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},i.a.createElement(R.a,{onChange:this.handleDateChange.bind(this),onBlur:this.handleDateBlur.bind(this),minDate:r,maxDate:o,required:!0,value:n,clearIcon:null,calendarIcon:i.a.createElement(v.a,{icon:k.c})}),i.a.createElement(I,{onClick:this.props.onClickReload.bind(this),disabled:!t})),i.a.createElement("div",{style:{textAlign:"center"}},a))}},{key:"handleDateChange",value:function(e){e.setHours(0),e.setMinutes(0),this.props.onDateChange(e)}},{key:"handleDateBlur",value:function(e){var t=!0;e&&e.relatedTarget&&e.relatedTarget.className.match(/(calendar|date-?picker)/)&&(t=!1),t&&this.props.onDateBlur(e)}}]),t}(i.a.PureComponent);B.defaultProps={onClickReload:function(e){},onDateBlur:function(e){},onDateChange:function(e){},completedDownload:!0,date:new Date,maxDate:new Date};var V=B,K=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderChildren",value:function(){var e=this.props,t=e.children,n=e.current;return void 0===t||0===t.length?null:t.map(function(e,t){return i.a.createElement("li",{key:e.key,style:{position:"relative",marginLeft:"2.5em",textIndent:"-1.5em",padding:"1pt 0"}},t===n?i.a.createElement(v.a,{icon:k.i,style:{position:"absolute",left:"-2.75em",padding:"1pt 0"}}):null,e)})}},{key:"render",value:function(){var e=this,t=this.props.children,n={listStyleType:"none",marginLeft:0,paddingLeft:0,textAlign:"left"};return void 0===t||0===t.length?null:i.a.createElement(w.a,{minWidth:1024},function(a){return i.a.createElement("ul",{style:Object(c.a)({},n,{columnCount:a&&Math.floor(t.length/10)||1})},e.renderChildren())})}}]),t}(i.a.PureComponent);K.defaultProps={};var z=K,G=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).handleClick=function(e){return n.props.onClick(e)},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.path,a=t.uuid,r=t.hour,o=t.minute,c=t.title;return i.a.createElement("span",null,n?i.a.createElement("a",{href:n,onClick:this.handleClick.bind(this),style:{textDecoration:"none"}},r,"h",o?((e=o)<10?"0":"")+e:"",": ",c):i.a.createElement("span",null,a))}}]),t}(i.a.PureComponent);G.defaultProps={onClick:function(e){}};var Y=G,$=function(){function e(t){Object(s.a)(this,e),this._podcastsData={},this._pages_uuids=[],this._previous_uuids=[],this.controller=new AbortController,this.dataAttrsFind=/ class="(audioteca-item|pagination-link)" /,this.dataAttrsClean=/.* (data-[^=]*)="([^"]*)".*/;this.onListUpdate=t.onListUpdate||function(){},this.setDate(t.date)}return Object(l.a)(e,[{key:"abort",value:function(){this.controller.abort()}},{key:"handleFetchErrors",value:function(e){if(!e.ok)throw Error(e.statusText);return e}},{key:"catchFetchErrors",value:function(e){"AbortError"===e.name?console.log(e.message):console.error(e)}},{key:"setDate",value:function(e){this.date!==e&&(this._previous_uuids=[]),this.date=e,this.updateList()}},{key:"updateList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0===e&&(this._pages_uuids=[],this.pages=[0],this.handleListUpdate()),this.getPodcastsUUIDs(e).then(this.getPodcasts.bind(this,e)).then(this.handleListUpdate.bind(this,e)).catch(this.catchFetchErrors)}},{key:"getPodcasts",value:function(e,t){var n=this;return t.map(function(t){return"..."===t.uuid||t.uuid in n._podcastsData||n.getPodcastData(t.uuid).then(n.handlePodcastUpdate.bind(n,e)).catch(n.catchFetchErrors),t})}},{key:"handleListUpdate",value:function(){var e=this,t=Object(x.a)(this._previous_uuids.filter(function(e){return"..."!==e.uuid})),n=!0,a=function(e){return"".concat(e.getFullYear(),"/").concat(e.getMonth()+1,"/").concat(e.getDate())},i=function(t){return!("date"in t)||(n=t.date,i=e.date,a(n)===a(i));var n,i};this.pages.forEach(function(a){var r=e._pages_uuids[a];void 0===r?(t.push({uuid:"..."}),n=!1):r.filter(function(e){return 0===t.filter(function(t){return t.uuid===e.uuid}).length}).filter(i).forEach(function(e){return t.push(e)})}),t=t.map(function(t){return e._podcastsData[t.uuid]||t}).filter(i),n&&(this._previous_uuids=t);var r=n&&t.every(function(e){return"path"in e});return this.onListUpdate(t,r),t}},{key:"handlePodcastUpdate",value:function(e,t){var n=this;t.page=e,this._pages_uuids[e].forEach(function(a,i){a.uuid===t.uuid&&(n._pages_uuids[e][i]=t)}),this.handleListUpdate(t)}},{key:"getPodcastsUUIDs",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getPage(t).then(function(n){var a=e.parsePage(n),i=a.uuidsPage,r=a.pages;return 0===t&&(e.pages=r.length>0?r.reverse():[0],e.pages.forEach(function(t){return 0!==t&&e.updateList(t)})),e._pages_uuids[t]=i.reverse().map(function(e){return{uuid:e,page:t}}),e._pages_uuids[t]})}},{key:"getPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=function(e){return(e<10?"0":"")+e},n=t(this.date.getDate())+"/"+t(1+this.date.getMonth())+"/"+this.date.getFullYear(),a=new Date(this.date.getTime());a.setDate(a.getDate()+1);var i="";return 2019===a.getFullYear()&&0===a.getMonth()&&1===a.getDate()||(i=t(a.getDate())+"/"+t(1+a.getMonth())+"/"+a.getFullYear()),fetch("https://cors-anywhere.herokuapp.com/https://api.audioteca.rac1.cat/a-la-carta/cerca?text=&programId=&sectionId=HOUR&"+"from=".concat(n,"&to=").concat(i,"&pageNumber=").concat(e),{credentials:"same-origin",signal:this.controller.signal}).then(this.handleFetchErrors).then(function(e){return e.text()})}},{key:"parsePage",value:function(e){var t=this,n=["data-audio-id","data-audioteca-search-page"],a=e.split("\n").filter(function(e){return t.dataAttrsFind.test(e)}).map(function(e){return e.replace(t.dataAttrsClean,"$1=$2")}).map(function(e){return e.split("=")}).filter(function(e){return n.includes(e[0])});return{uuidsPage:a.filter(function(e){return"data-audio-id"===e[0]}).map(function(e){return e[1]}),pages:a.filter(function(e){return"data-audioteca-search-page"===e[0]}).map(function(e){return Number(e[1])})}}},{key:"getPodcastData",value:function(e){var t=this;return e in this._podcastsData?new Promise(function(n){return n(t._podcastsData[e])}):fetch("https://api.audioteca.rac1.cat/piece/audio?id=".concat(e),{signal:this.controller.signal}).then(this.handleFetchErrors).then(function(e){return e.json()}).then(function(n){return n.dateTime.startsWith("".concat(t.date.getFullYear()+1,"-").concat(t.date.getMonth()+1))&&(n.dateTime=n.dateTime.replace("".concat(t.date.getFullYear()+1),"".concat(t.date.getFullYear())),console.log("Podcast date in future. Fixing to: "+n.dateTime)),n.uuid=e,n.date=new Date(n.dateTime),n.hour=Number(n.audio.time.split(":")[0]),n.minute=Number(n.audio.time.split(":")[1]),n.title=n.appTabletTitle.replace(/ \d\d\/.*/,""),n.titleFull=n.appTabletTitle,n.path=n.path.replace(/\/get\//,"/file/").replace(/\/(\d)\//,"/$1/-/"),t._podcastsData[e]=n,n})}}]),e}(),J=function(e){function t(e,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this))).history=e.history,a.initialTitle=document.title,a.state={podcasts:[{uuid:"..."}],currentUUID:"",date:a.getDateFromParams(e),maxDate:new Date,volume:1,muted:!1,isPlaying:!1,completed:!1,waitingUpdate:!1,showAdvancedControls:!1},a.extraControls=[{help:"Reload playlist",action:a.handleClickReload.bind(Object(H.a)(Object(H.a)(a))),keys:["r","R"]}],a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getDateFromParams",value:function(e){var t=e.match.params;return new Date(t.year,t.month-1,t.day,t.hour||0,t.minute||0)}}]),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.unlisten=this.history.listen(this.handleHistoryChange.bind(this)),this.rac1=new $({date:this.state.date,onListUpdate:this.handleListUpdate.bind(this)})}},{key:"componentWillUnmount",value:function(){this.unlisten(),this.rac1.abort(),document.title=this.initialTitle}},{key:"render",value:function(){var e=this,t=this.state,n=t.podcasts,a=t.volume,r=t.muted,o=t.completed,s=t.date,l=t.maxDate,u=t.isPlaying,d=t.showAdvancedControls,h=s instanceof Date?"".concat(s.getDate(),"/").concat(1+s.getMonth(),"/").concat(s.getFullYear()):"...",p=this.findCurrentPodcast(),m=p>0,f=void 0!==n&&n.length>p&&"path"in n[p]?n[p].path:"",y=void 0!==n&&n.length>0&&"audio"in n[p]?"".concat(n[p].titleFull):h,g=i.a.createElement(W,{getPlayer:this.player.bind(this),volume:a,muted:r,allowFocus:function(e){return e.className.match(/date-?picker|rc-slider-handle/)},onPlayNext:this.playNext.bind(this),onPlayPrev:this.playPrev.bind(this),onSetVolume:function(t){return e.setState(Object(c.a)({},e.state,{volume:t}))},onSetMuted:function(t){return e.setState(Object(c.a)({},e.state,{muted:t}))},showAdvanced:d,volumeAsAdvanced:!0,onShowAdvancedChange:function(t){return e.setState(Object(c.a)({},e.state,{showAdvancedControls:t}))},isPlaying:u,ref:function(t){t&&(e.keyHandlerFocus=t.keyHandlerFocus)},extraControls:this.extraControls}),v=i.a.createElement(D.a,{ref:function(t){e._player=t},style:{width:"100%"},src:f,autoPlay:m,title:y,controls:!0,controlsList:"nodownload",preload:m?"auto":"metadata",onEnded:this.playNext.bind(this),volume:a,muted:r,onPlay:this.handlePlayStatusChange.bind(this,!0),onPause:this.handlePlayStatusChange.bind(this,!1),onVolumeChanged:function(t){return e.setState(Object(c.a)({},e.state,{volume:t.currentTarget.volume,muted:t.currentTarget.muted}))}}),k=i.a.createElement(V,{date:s,minDate:new Date(2015,5,1),maxDate:l,completedDownload:o,onClickReload:this.handleClickReload.bind(this),onDateBlur:function(){return e.keyHandlerFocus()},onDateChange:this.handleDateChange.bind(this)},i.a.createElement(z,{current:p},n.map(function(t,n){return i.a.createElement(Y,Object.assign({key:"..."!==t.uuid?t.uuid:"..._".concat(n)},t,{onClick:e.handlePodcastClick.bind(e,n)}))})));return i.a.createElement(w.a,{minWidth:1024},function(e){return e?i.a.createElement("div",{style:{display:"flex",alignItems:"stretch"}},i.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"space-evenly"}},i.a.createElement("h3",null,y),g,v),k):i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",null,y),g,v,k)})}},{key:"handleHistoryChange",value:function(e,t){var n=this.getDateFromParams(this.props),a=this.state.date;"POP"===t&&(a.getFullYear()!==n.getFullYear()||a.getMonth()!==n.getMonth()||a.getDate()!==n.getDate()?this.handleDateChange(n):a.getHours()===n.getHours()&&a.getMinutes()===n.getMinutes()||(this.setState(Object(c.a)({},this.state,{currentUUID:"",dateNew:n})),this.selectPodcastByDate(n,!1)))}},{key:"historyPush",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="/".concat(e.getFullYear(),"/").concat(1+e.getMonth(),"/").concat(e.getDate(),"/").concat(e.getHours(),"/").concat(e.getMinutes());this.history.location.pathname!==n&&(t?this.history.replace(n):this.history.push(n))}},{key:"handlePlayStatusChange",value:function(e){this.setState(Object(c.a)({},this.state,{isPlaying:e}))}},{key:"handleListUpdate",value:function(e,t){var n=this.state,a=n.waitingUpdate,i=n.currentUUID,r=n.date,o=(!a||!t)&&a;this.setState(Object(c.a)({},this.state,{podcasts:e,completed:t,waitingUpdate:o,maxDate:new Date})),t&&""===i&&this.selectPodcastByDate(r),!0===a&&!1===o&&this.playNext(!1)}},{key:"handleDateChange",value:function(e){var t=this;e!==this.state.date&&(this.setState(Object(c.a)({},this.state,{currentUUID:"",date:e})),null!==e&&(this.historyPush(e),setTimeout(function(){return t.rac1.setDate(e)},50)))}},{key:"handlePodcastsLastRemove",value:function(){this.setState(Object(c.a)({},this.state,{podcasts:Object(x.a)(this.state.podcasts).slice(0,-1)}))}},{key:"handleClickReload",value:function(){if(this.state.completed)return this.setState(Object(c.a)({},this.state,{completed:!1})),this.rac1.updateList()}},{key:"selectPodcastByDate",value:function(e){var t=this.state.podcasts.filter(function(t){return t.hour>=e.getHours()&&(t.hour>e.getHours()||t.minute>=e.getMinutes())});t.length>0&&this.playPodcast(this.findPodcastByUUID(t[0].uuid))}},{key:"findPodcastByUUID",value:function(e){var t=0;return this.state.podcasts.forEach(function(n,a){n.uuid===e&&(t=a)}),t}},{key:"findCurrentPodcast",value:function(){return this.findPodcastByUUID(this.state.currentUUID)}},{key:"playPodcast",value:function(e){var t,n=this.state,a=n.date,i=n.currentUUID,r=this.state.podcasts[e];r.hour===a.getHours()&&r.minute===a.getMinutes()||(a.setHours(Number(r.hour)),a.setMinutes(Number(r.minute))),t=""===i,document.title="".concat(this.initialTitle,": ").concat(r.titleFull),this.setState(Object(c.a)({},this.state,{currentUUID:r.uuid,date:a})),this.historyPush(a,t)}},{key:"playPrev",value:function(){var e=this.findCurrentPodcast();e>0&&this.playPodcast(e-1)}},{key:"playNext",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.findCurrentPodcast();t<this.state.podcasts.length-1&&"path"in this.state.podcasts[t]?this.playPodcast(t+1):e&&(this.state.waitingUpdate||(this.handleClickReload(),this.setState(Object(c.a)({},this.state,{waitingUpdate:!0}))))}},{key:"player",value:function(){return this._player.audioEl}},{key:"handlePodcastClick",value:function(e,t){t.stopPropagation(),t.preventDefault(),this.playPodcast(e)}}]),t}(a.Component),q=(n(221),function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(d.a)(t).call(this))).registration=!1,e.state={newServiceWorkerDetected:!1},e}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("onNewServiceWorker",this.handleNewServiceWorker.bind(this))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("onNewServiceWorker",this.handleNewServiceWorker.bind(this))}},{key:"handleNewServiceWorker",value:function(e){this.registration=e.detail.registration,this.setState(Object(c.a)({},this.state,{newServiceWorkerDetected:!0}))}},{key:"render",value:function(){var e=new Date,t="/".concat(e.getFullYear(),"/").concat(1+e.getMonth(),"/").concat(e.getDate(),"/0/0"),n=this.state.newServiceWorkerDetected;return i.a.createElement(p.a,null,i.a.createElement("div",{className:"App",id:"outer-container"},i.a.createElement(P,{newServiceWorkerDetected:n,onLoadNewServiceWorkerAccept:this.handleLoadNewServiceWorkerAccept.bind(this)}),i.a.createElement("header",{className:"App-header",id:"page-wrap"},i.a.createElement(O.a,null,i.a.createElement(m.a,null,i.a.createElement(f.a,{path:"/directe",render:function(e){return i.a.createElement(L,e)}}),i.a.createElement(f.a,{path:"/:year/:month/:day/:hour/:minute",render:function(e){return i.a.createElement(J,e)}}),i.a.createElement(f.a,{path:"/:year/:month/:day/:hour",render:function(e){return i.a.createElement(J,e)}}),i.a.createElement(f.a,{path:"/:year/:month/:day",render:function(e){return i.a.createElement(J,e)}}),i.a.createElement(y.a,{to:{pathname:t}}))))))}},{key:"handleLoadNewServiceWorkerAccept",value:function(){this.props.onLoadNewServiceWorkerAccept(this.registration)}}]),t}(i.a.Component));q.defaultProps={onLoadNewServiceWorkerAccept:function(e){}};var Q=q,X=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Z(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(i.a.createElement(Q,{onLoadNewServiceWorkerAccept:function(e){var t;e.waiting&&(navigator.serviceWorker.addEventListener("controllerchange",function(e){t||(t=!0,console.log("Controller loaded"),window.location.reload())}),e.waiting.postMessage("skipWaiting"))}}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/Rac1.js",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/Rac1.js","/service-worker.js");X?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Z(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Z(t,e)})}}({onUpdate:function(e){var t=new CustomEvent("onNewServiceWorker",{detail:{registration:e}});document.dispatchEvent(t)}})}},[[111,2,1]]]);
//# sourceMappingURL=main.23ab1e0a.chunk.js.map